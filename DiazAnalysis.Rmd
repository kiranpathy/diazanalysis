---
title: "Edwin Diaz Pitcher Analysis"
output: html_document
date: "2025-04-13"
---

# Intro

This project will be an analysis into Edwin Diaz across 2022, 2024, and 2025 seasons (so far), looking into his decline in effectiveness and his changing approach. His 2022 season was historical, and while his metrics from 2024 indicate a strong campaign, his 2025 season has gotten off to a troubling start (NOTE: this is being made with data as of 4/13/2025, 5.2 IP / 6 G into the season for Diaz).

```{r}
library(plyr)
library(dplyr)
library(devtools)
library(DT)
library(ggplot2)
library(ggrepel)
library(ggthemes)
library(gridExtra)
library(janitor)
library(plotly)
library(stringr)
library(tidyr)
library(tidyselect)
library(tidyverse)
library(data.table)
library(reactable)
library(lubridate)
library(ggpubr)
library(paletteer)
library(knitr)
library(gt)
```

# Data and Plots

Before discussing, it's important to look into some relevant ready-available metrics to evaluate Diaz's 2022, 2024 and 2025 seasons in comparison and to understand why there are concerns.

First load in data from the three seasons in question and define strike zone dimensions and making proper adjustments (make it from pitcher's view).

```{r}
diaz <- read_csv("diaz.csv")

heat_colors_interpolated <- colorRampPalette(paletteer_d("RColorBrewer::RdBu", 
                                                         n = 9,
                                                         direction = -1))(16)
left <- -8.5 / 12
right <- 8.5 / 12
bottom <- 18.29 / 12
top <- 44.08 / 12
width <- (right - left) / 3
height <- (top - bottom) / 3

diaz <- diaz %>%
  mutate(plate_x = plate_x * -1)

diaz_22 <- diaz %>%
  filter(game_year == "2022")
diaz_24 <- diaz %>%
  filter(game_year == "2024")
diaz_25 <- diaz %>%
  filter(game_year == "2025")
```

Now, onto the plots. First, I want to visualize Diaz's different pitches. We can see that he only has thrown a fastball and slider over these three years (can see this by doing `unique(diaz$pitch_type)`).

```{r}
#2022
diaz_ff_22 <- diaz_22

freq_ff_22 <- diaz_ff_22 %>%
  group_by(pitch_type) %>%
  tally()

total <- sum(freq_ff_22$n)

freq_ff_22$usage_percent <- round((freq_ff_22$n / total)*100, digits = 0)
freq_ff_22 <- subset(freq_ff_22, select = -c(n))

diaz_ff_22 <- merge(diaz_ff_22, freq_ff_22)

diaz_ff_22 <- diaz_ff_22 %>%
  filter(pitch_type == "FF")

ff_total_22 <- diaz_ff_22 %>%
  ggplot(aes(x = plate_x, y = plate_z)) +
  stat_density2d_filled() +
  scale_fill_manual(values = c(heat_colors_interpolated), aesthetics = c("fill" , "color")) +
  geom_segment(x = left, y = bottom, xend = right, yend = bottom) +
  geom_segment(x = left, y = top, xend = right, yend = top) +
  geom_segment(x = left, y = bottom, xend = left, yend = top) +
  geom_segment(x = right, y = bottom, xend = right, yend = top) +
  geom_segment(x = left, y = (bottom + height), xend = right, yend = (bottom + height)) +
  geom_segment(x = left, y = (top - height), xend = right, yend = (top - height)) +
  geom_segment(x = (left + width), y = bottom, xend = (left + width), yend = top) +
  geom_segment(x = (right - width), y = bottom, xend = (right - width), yend = top) +
  geom_segment(x = left, y = 0, xend = right, yend = 0) +
  geom_segment(x = left, y = 0, xend = left, yend = (4.25/12)) +
  geom_segment(x = left, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = 0, xend = right, yend = (4.25/12)) +
  xlim(-3,3) + ylim(0, 5) +
  coord_fixed() +
  ggtitle(paste("Fastball"), paste(diaz_ff_22$usage_percent,"%")) +
  theme(legend.position = "none",
        plot.title = element_text(color = "black", size = 15, face = "bold"),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        panel.border = element_rect(color = "black", size = 1.5, fill = NA))

diaz_sl_22 <- diaz_22

freq_sl_22 <- diaz_sl_22 %>%
  group_by(pitch_type) %>%
  tally()

total <- sum(freq_sl_22$n)

freq_sl_22$usage_percent <- round((freq_sl_22$n / total)*100, digits = 0)
freq_sl_22 <- subset(freq_sl_22, select = -c(n))

diaz_sl_22 <- merge(diaz_sl_22, freq_sl_22)

diaz_sl_22 <- diaz_sl_22 %>%
  filter(pitch_type == "SL")

sl_total_22 <- diaz_sl_22 %>%
  ggplot(aes(x = plate_x, y = plate_z)) +
  stat_density2d_filled() +
  scale_fill_manual(values = c(heat_colors_interpolated), aesthetics = c("fill" , "color")) +
  geom_segment(x = left, y = bottom, xend = right, yend = bottom) +
  geom_segment(x = left, y = top, xend = right, yend = top) +
  geom_segment(x = left, y = bottom, xend = left, yend = top) +
  geom_segment(x = right, y = bottom, xend = right, yend = top) +
  geom_segment(x = left, y = (bottom + height), xend = right, yend = (bottom + height)) +
  geom_segment(x = left, y = (top - height), xend = right, yend = (top - height)) +
  geom_segment(x = (left + width), y = bottom, xend = (left + width), yend = top) +
  geom_segment(x = (right - width), y = bottom, xend = (right - width), yend = top) +
  geom_segment(x = left, y = 0, xend = right, yend = 0) +
  geom_segment(x = left, y = 0, xend = left, yend = (4.25/12)) +
  geom_segment(x = left, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = 0, xend = right, yend = (4.25/12)) +
  xlim(-3,3) + ylim(0, 5) + 
  coord_fixed() +
  ggtitle(paste("Slider"), paste(diaz_sl_22$usage_percent,"%")) +
  theme(legend.position = "none",
        plot.title = element_text(color = "black", size = 15, face = "bold"),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        panel.border = element_rect(color = "black", size = 1.5, fill = NA))

#2024
diaz_ff_24 <- diaz_24

freq_ff_24 <- diaz_ff_24 %>%
  group_by(pitch_type) %>%
  tally()

total <- sum(freq_ff_24$n)

freq_ff_24$usage_percent <- round((freq_ff_24$n / total)*100, digits = 0)
freq_ff_24 <- subset(freq_ff_24, select = -c(n))

diaz_ff_24 <- merge(diaz_ff_24, freq_ff_24)

diaz_ff_24 <- diaz_ff_24 %>%
  filter(pitch_type == "FF")

ff_total_24 <- diaz_ff_24 %>%
  ggplot(aes(x = plate_x, y = plate_z)) +
  stat_density2d_filled() +
  scale_fill_manual(values = c(heat_colors_interpolated), aesthetics = c("fill" , "color")) +
  geom_segment(x = left, y = bottom, xend = right, yend = bottom) +
  geom_segment(x = left, y = top, xend = right, yend = top) +
  geom_segment(x = left, y = bottom, xend = left, yend = top) +
  geom_segment(x = right, y = bottom, xend = right, yend = top) +
  geom_segment(x = left, y = (bottom + height), xend = right, yend = (bottom + height)) +
  geom_segment(x = left, y = (top - height), xend = right, yend = (top - height)) +
  geom_segment(x = (left + width), y = bottom, xend = (left + width), yend = top) +
  geom_segment(x = (right - width), y = bottom, xend = (right - width), yend = top) +
  geom_segment(x = left, y = 0, xend = right, yend = 0) +
  geom_segment(x = left, y = 0, xend = left, yend = (4.25/12)) +
  geom_segment(x = left, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = 0, xend = right, yend = (4.25/12)) +
  xlim(-3,3) + ylim(0, 5) +
  coord_fixed() +
  ggtitle(paste("Fastball"), paste(diaz_ff_24$usage_percent,"%")) +
  theme(legend.position = "none",
        plot.title = element_text(color = "black", size = 15, face = "bold"),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        panel.border = element_rect(color = "black", size = 1.5, fill = NA))

diaz_sl_24 <- diaz_24

freq_sl_24 <- diaz_sl_24 %>%
  group_by(pitch_type) %>%
  tally()

total <- sum(freq_sl_24$n)

freq_sl_24$usage_percent <- round((freq_sl_24$n / total)*100, digits = 0)
freq_sl_24 <- subset(freq_sl_24, select = -c(n))

diaz_sl_24 <- merge(diaz_sl_24, freq_sl_24)

diaz_sl_24 <- diaz_sl_24 %>%
  filter(pitch_type == "SL")

sl_total_24 <- diaz_sl_24 %>%
  ggplot(aes(x = plate_x, y = plate_z)) +
  stat_density2d_filled() +
  scale_fill_manual(values = c(heat_colors_interpolated), aesthetics = c("fill" , "color")) +
  geom_segment(x = left, y = bottom, xend = right, yend = bottom) +
  geom_segment(x = left, y = top, xend = right, yend = top) +
  geom_segment(x = left, y = bottom, xend = left, yend = top) +
  geom_segment(x = right, y = bottom, xend = right, yend = top) +
  geom_segment(x = left, y = (bottom + height), xend = right, yend = (bottom + height)) +
  geom_segment(x = left, y = (top - height), xend = right, yend = (top - height)) +
  geom_segment(x = (left + width), y = bottom, xend = (left + width), yend = top) +
  geom_segment(x = (right - width), y = bottom, xend = (right - width), yend = top) +
  geom_segment(x = left, y = 0, xend = right, yend = 0) +
  geom_segment(x = left, y = 0, xend = left, yend = (4.25/12)) +
  geom_segment(x = left, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = 0, xend = right, yend = (4.25/12)) +
  xlim(-3,3) + ylim(0, 5) + 
  coord_fixed() +
  ggtitle(paste("Slider"), paste(diaz_sl_24$usage_percent,"%")) +
  theme(legend.position = "none",
        plot.title = element_text(color = "black", size = 15, face = "bold"),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        panel.border = element_rect(color = "black", size = 1.5, fill = NA))

#2025
diaz_ff_25 <- diaz_25

freq_ff_25 <- diaz_ff_25 %>%
  group_by(pitch_type) %>%
  tally()

total <- sum(freq_ff_25$n)

freq_ff_25$usage_percent <- round((freq_ff_25$n / total)*100, digits = 0)
freq_ff_25 <- subset(freq_ff_25, select = -c(n))

diaz_ff_25 <- merge(diaz_ff_25, freq_ff_25)

diaz_ff_25 <- diaz_ff_25 %>%
  filter(pitch_type == "FF")

ff_total_25 <- diaz_ff_25 %>%
  ggplot(aes(x = plate_x, y = plate_z)) +
  stat_density2d_filled() +
  scale_fill_manual(values = c(heat_colors_interpolated), aesthetics = c("fill" , "color")) +
  geom_segment(x = left, y = bottom, xend = right, yend = bottom) +
  geom_segment(x = left, y = top, xend = right, yend = top) +
  geom_segment(x = left, y = bottom, xend = left, yend = top) +
  geom_segment(x = right, y = bottom, xend = right, yend = top) +
  geom_segment(x = left, y = (bottom + height), xend = right, yend = (bottom + height)) +
  geom_segment(x = left, y = (top - height), xend = right, yend = (top - height)) +
  geom_segment(x = (left + width), y = bottom, xend = (left + width), yend = top) +
  geom_segment(x = (right - width), y = bottom, xend = (right - width), yend = top) +
  geom_segment(x = left, y = 0, xend = right, yend = 0) +
  geom_segment(x = left, y = 0, xend = left, yend = (4.25/12)) +
  geom_segment(x = left, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = 0, xend = right, yend = (4.25/12)) +
  xlim(-3,3) + ylim(0, 5) +
  coord_fixed() +
  ggtitle(paste("Fastball"), paste(diaz_ff_25$usage_percent,"%")) +
  theme(legend.position = "none",
        plot.title = element_text(color = "black", size = 15, face = "bold"),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        panel.border = element_rect(color = "black", size = 1.5, fill = NA))

diaz_sl_25 <- diaz_25

freq_sl_25 <- diaz_sl_25 %>%
  group_by(pitch_type) %>%
  tally()

total <- sum(freq_sl_25$n)

freq_sl_25$usage_percent <- round((freq_sl_25$n / total)*100, digits = 0)
freq_sl_25 <- subset(freq_sl_25, select = -c(n))

diaz_sl_25 <- merge(diaz_sl_25, freq_sl_25)

diaz_sl_25 <- diaz_sl_25 %>%
  filter(pitch_type == "SL")

sl_total_25 <- diaz_sl_25 %>%
  ggplot(aes(x = plate_x, y = plate_z)) +
  stat_density2d_filled() +
  scale_fill_manual(values = c(heat_colors_interpolated), aesthetics = c("fill" , "color")) +
  geom_segment(x = left, y = bottom, xend = right, yend = bottom) +
  geom_segment(x = left, y = top, xend = right, yend = top) +
  geom_segment(x = left, y = bottom, xend = left, yend = top) +
  geom_segment(x = right, y = bottom, xend = right, yend = top) +
  geom_segment(x = left, y = (bottom + height), xend = right, yend = (bottom + height)) +
  geom_segment(x = left, y = (top - height), xend = right, yend = (top - height)) +
  geom_segment(x = (left + width), y = bottom, xend = (left + width), yend = top) +
  geom_segment(x = (right - width), y = bottom, xend = (right - width), yend = top) +
  geom_segment(x = left, y = 0, xend = right, yend = 0) +
  geom_segment(x = left, y = 0, xend = left, yend = (4.25/12)) +
  geom_segment(x = left, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = 0, xend = right, yend = (4.25/12)) +
  xlim(-3,3) + ylim(0, 5) + 
  coord_fixed() +
  ggtitle(paste("Slider"), paste(diaz_sl_25$usage_percent,"%")) +
  theme(legend.position = "none",
        plot.title = element_text(color = "black", size = 15, face = "bold"),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        panel.border = element_rect(color = "black", size = 1.5, fill = NA))

#2022 Plot
plot_22 <- ggarrange(ff_total_22,
          sl_total_22, nrow = 1, ncol = 2) %>%
  annotate_figure(plot, top = text_grob("Diaz 2022 (Contour)", 
                                        color = "red", face = "italic", size = 14))
plot_24 <- ggarrange(ff_total_24,
          sl_total_24, nrow = 1, ncol = 2) %>%
  annotate_figure(plot, top = text_grob("Diaz 2024 (Contour)", 
                                        color = "red", face = "italic", size = 14))

plot_25 <- ggarrange(ff_total_25,
          sl_total_25, nrow = 1, ncol = 2) %>%
  annotate_figure(plot, top = text_grob("Diaz 2025 (Contour)", 
                                        color = "red", face = "italic", size = 14))

plot_22
plot_24
plot_25
```

One interesting takeaway from these plots is the differentiation in the pitch usage. Diaz is less reliant on his slider compared to his successful 2022 season, and his fastball has begun to creep up higher in the zone. With the fastball climbing up in the zone, his approach seems to be changing - instead of tunneling effectively in the left half of the zone with fastball and slider, he seems to just be trying to blow fastballs by hitters up and away. I also think that this shift is related to changes in control. Diaz has noticeably been working from behind in the count much more often as of late - from [Baseball Savant](https://baseballsavant.mlb.com/savant-player/edwin-diaz-621242?stats=statcast-r-pitching-mlb&season=2025), Diaz's FirstPitchStrike% by season looks like 71.4% (2022), 63.0% (2024), and 50.0% (2025, through April 12 games). Since this is a big dropoff and can explain the tendency for more fastballs, I'd like to look at how he has approached 0-0 counts and if there's a difference over the years.

```{r}
#set counts variable in new df
diaz <- diaz %>%
  mutate(count = paste0(balls, "-", strikes))
#filter for 0-0 count (what we want just for now)
diaz_00 <- diaz %>%
  filter(count == "0-0")

#2022
diaz_ff_22_00 <- diaz_00 %>%
  filter(game_year == "2022")

freq_ff_22_00 <- diaz_ff_22_00 %>%
  group_by(pitch_type) %>%
  tally()

total <- sum(freq_ff_22_00$n)

freq_ff_22_00$usage_percent <- round((freq_ff_22_00$n / total)*100, digits = 0)
freq_ff_22_00 <- subset(freq_ff_22_00, select = -c(n))

diaz_ff_22_00 <- merge(diaz_ff_22_00, freq_ff_22_00)

diaz_ff_22_00 <- diaz_ff_22_00 %>%
  filter(pitch_type == "FF")

ff_total_22_00 <- diaz_ff_22_00 %>%
  ggplot(aes(x = plate_x, y = plate_z)) +
  geom_point(aes(color = pitch_type), size = 1) +
  geom_segment(x = left, y = bottom, xend = right, yend = bottom) +
  geom_segment(x = left, y = top, xend = right, yend = top) +
  geom_segment(x = left, y = bottom, xend = left, yend = top) +
  geom_segment(x = right, y = bottom, xend = right, yend = top) +
  geom_segment(x = left, y = (bottom + height), xend = right, yend = (bottom + height)) +
  geom_segment(x = left, y = (top - height), xend = right, yend = (top - height)) +
  geom_segment(x = (left + width), y = bottom, xend = (left + width), yend = top) +
  geom_segment(x = (right - width), y = bottom, xend = (right - width), yend = top) +
  geom_segment(x = left, y = 0, xend = right, yend = 0) +
  geom_segment(x = left, y = 0, xend = left, yend = (4.25/12)) +
  geom_segment(x = left, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = 0, xend = right, yend = (4.25/12)) +
  xlim(-3,3) + ylim(0, 5) +
  coord_fixed() +
  ggtitle(paste("Fastball"), paste(diaz_ff_22_00$usage_percent,"%")) +
  theme(legend.position = "none",
        plot.title = element_text(color = "black", size = 15, face = "bold"),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        panel.border = element_rect(color = "black", size = 1.5, fill = NA))


diaz_sl_22_00 <- diaz_00 %>%
  filter(game_year == "2022")

freq_sl_22_00 <- diaz_sl_22_00 %>%
  group_by(pitch_type) %>%
  tally()

total <- sum(freq_sl_22_00$n)

freq_sl_22_00$usage_percent <- round((freq_sl_22_00$n / total)*100, digits = 0)
freq_sl_22_00 <- subset(freq_sl_22_00, select = -c(n))

diaz_sl_22_00 <- merge(diaz_sl_22_00, freq_sl_22_00)

diaz_sl_22_00 <- diaz_sl_22_00 %>%
  filter(pitch_type == "SL")

sl_total_22_00 <- diaz_sl_22_00 %>%
  ggplot(aes(x = plate_x, y = plate_z)) +
  geom_point(aes(color = pitch_type), size = 1) +
  geom_segment(x = left, y = bottom, xend = right, yend = bottom) +
  geom_segment(x = left, y = top, xend = right, yend = top) +
  geom_segment(x = left, y = bottom, xend = left, yend = top) +
  geom_segment(x = right, y = bottom, xend = right, yend = top) +
  geom_segment(x = left, y = (bottom + height), xend = right, yend = (bottom + height)) +
  geom_segment(x = left, y = (top - height), xend = right, yend = (top - height)) +
  geom_segment(x = (left + width), y = bottom, xend = (left + width), yend = top) +
  geom_segment(x = (right - width), y = bottom, xend = (right - width), yend = top) +
  geom_segment(x = left, y = 0, xend = right, yend = 0) +
  geom_segment(x = left, y = 0, xend = left, yend = (4.25/12)) +
  geom_segment(x = left, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = 0, xend = right, yend = (4.25/12)) +
  xlim(-3,3) + ylim(0, 5) +
  coord_fixed() +
  ggtitle(paste("Slider"), paste(diaz_sl_22_00$usage_percent,"%")) +
  theme(legend.position = "none",
        plot.title = element_text(color = "black", size = 15, face = "bold"),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        panel.border = element_rect(color = "black", size = 1.5, fill = NA))

#2024
diaz_ff_24_00 <- diaz_00 %>%
  filter(game_year == "2024")

freq_ff_24_00 <- diaz_ff_24_00 %>%
  group_by(pitch_type) %>%
  tally()

total <- sum(freq_ff_24_00$n)

freq_ff_24_00$usage_percent <- round((freq_ff_24_00$n / total)*100, digits = 0)
freq_ff_24_00 <- subset(freq_ff_24_00, select = -c(n))

diaz_ff_24_00 <- merge(diaz_ff_24_00, freq_ff_24_00)

diaz_ff_24_00 <- diaz_ff_24_00 %>%
  filter(pitch_type == "FF")

ff_total_24_00 <- diaz_ff_24_00 %>%
  ggplot(aes(x = plate_x, y = plate_z)) +
  geom_point(aes(color = pitch_type), size = 1) +
  geom_segment(x = left, y = bottom, xend = right, yend = bottom) +
  geom_segment(x = left, y = top, xend = right, yend = top) +
  geom_segment(x = left, y = bottom, xend = left, yend = top) +
  geom_segment(x = right, y = bottom, xend = right, yend = top) +
  geom_segment(x = left, y = (bottom + height), xend = right, yend = (bottom + height)) +
  geom_segment(x = left, y = (top - height), xend = right, yend = (top - height)) +
  geom_segment(x = (left + width), y = bottom, xend = (left + width), yend = top) +
  geom_segment(x = (right - width), y = bottom, xend = (right - width), yend = top) +
  geom_segment(x = left, y = 0, xend = right, yend = 0) +
  geom_segment(x = left, y = 0, xend = left, yend = (4.25/12)) +
  geom_segment(x = left, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = 0, xend = right, yend = (4.25/12)) +
  xlim(-3,3) + ylim(0, 5) +
  coord_fixed() +
  ggtitle(paste("Fastball"), paste(diaz_ff_24_00$usage_percent,"%")) +
  theme(legend.position = "none",
        plot.title = element_text(color = "black", size = 15, face = "bold"),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        panel.border = element_rect(color = "black", size = 1.5, fill = NA))


diaz_sl_24_00 <- diaz_00 %>%
  filter(game_year == "2024")

freq_sl_24_00 <- diaz_sl_24_00 %>%
  group_by(pitch_type) %>%
  tally()

total <- sum(freq_sl_24_00$n)

freq_sl_24_00$usage_percent <- round((freq_sl_24_00$n / total)*100, digits = 0)
freq_sl_24_00 <- subset(freq_sl_24_00, select = -c(n))

diaz_sl_24_00 <- merge(diaz_sl_24_00, freq_sl_24_00)

diaz_sl_24_00 <- diaz_sl_24_00 %>%
  filter(pitch_type == "SL")

sl_total_24_00 <- diaz_sl_24_00 %>%
  ggplot(aes(x = plate_x, y = plate_z)) +
  geom_point(aes(color = pitch_type), size = 1) +
  geom_segment(x = left, y = bottom, xend = right, yend = bottom) +
  geom_segment(x = left, y = top, xend = right, yend = top) +
  geom_segment(x = left, y = bottom, xend = left, yend = top) +
  geom_segment(x = right, y = bottom, xend = right, yend = top) +
  geom_segment(x = left, y = (bottom + height), xend = right, yend = (bottom + height)) +
  geom_segment(x = left, y = (top - height), xend = right, yend = (top - height)) +
  geom_segment(x = (left + width), y = bottom, xend = (left + width), yend = top) +
  geom_segment(x = (right - width), y = bottom, xend = (right - width), yend = top) +
  geom_segment(x = left, y = 0, xend = right, yend = 0) +
  geom_segment(x = left, y = 0, xend = left, yend = (4.25/12)) +
  geom_segment(x = left, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = 0, xend = right, yend = (4.25/12)) +
  xlim(-3,3) + ylim(0, 5) +
  coord_fixed() +
  ggtitle(paste("Slider"), paste(diaz_sl_24_00$usage_percent,"%")) +
  theme(legend.position = "none",
        plot.title = element_text(color = "black", size = 15, face = "bold"),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        panel.border = element_rect(color = "black", size = 1.5, fill = NA))

#2025
diaz_ff_25_00 <- diaz_00 %>%
  filter(game_year == "2025")

freq_ff_25_00 <- diaz_ff_25_00 %>%
  group_by(pitch_type) %>%
  tally()

total <- sum(freq_ff_25_00$n)

freq_ff_25_00$usage_percent <- round((freq_ff_25_00$n / total)*100, digits = 0)
freq_ff_25_00 <- subset(freq_ff_25_00, select = -c(n))

diaz_ff_25_00 <- merge(diaz_ff_25_00, freq_ff_25_00)

diaz_ff_25_00 <- diaz_ff_25_00 %>%
  filter(pitch_type == "FF")

ff_total_25_00 <- diaz_ff_25_00 %>%
  ggplot(aes(x = plate_x, y = plate_z)) +
  geom_point(aes(color = pitch_type), size = 1) +
  geom_segment(x = left, y = bottom, xend = right, yend = bottom) +
  geom_segment(x = left, y = top, xend = right, yend = top) +
  geom_segment(x = left, y = bottom, xend = left, yend = top) +
  geom_segment(x = right, y = bottom, xend = right, yend = top) +
  geom_segment(x = left, y = (bottom + height), xend = right, yend = (bottom + height)) +
  geom_segment(x = left, y = (top - height), xend = right, yend = (top - height)) +
  geom_segment(x = (left + width), y = bottom, xend = (left + width), yend = top) +
  geom_segment(x = (right - width), y = bottom, xend = (right - width), yend = top) +
  geom_segment(x = left, y = 0, xend = right, yend = 0) +
  geom_segment(x = left, y = 0, xend = left, yend = (4.25/12)) +
  geom_segment(x = left, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = 0, xend = right, yend = (4.25/12)) +
  xlim(-3,3) + ylim(0, 5) +
  coord_fixed() +
  ggtitle(paste("Fastball"), paste(diaz_ff_25_00$usage_percent,"%")) +
  theme(legend.position = "none",
        plot.title = element_text(color = "black", size = 15, face = "bold"),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        panel.border = element_rect(color = "black", size = 1.5, fill = NA))


diaz_sl_25_00 <- diaz_00 %>%
  filter(game_year == "2025")

freq_sl_25_00 <- diaz_sl_25_00 %>%
  group_by(pitch_type) %>%
  tally()

total <- sum(freq_sl_25_00$n)

freq_sl_25_00$usage_percent <- round((freq_sl_25_00$n / total)*100, digits = 0)
freq_sl_25_00 <- subset(freq_sl_25_00, select = -c(n))

diaz_sl_25_00 <- merge(diaz_sl_25_00, freq_sl_25_00)

diaz_sl_25_00 <- diaz_sl_25_00 %>%
  filter(pitch_type == "SL")

sl_total_25_00 <- diaz_sl_25_00 %>%
  ggplot(aes(x = plate_x, y = plate_z)) +
  geom_point(aes(color = pitch_type), size = 1) +
  geom_segment(x = left, y = bottom, xend = right, yend = bottom) +
  geom_segment(x = left, y = top, xend = right, yend = top) +
  geom_segment(x = left, y = bottom, xend = left, yend = top) +
  geom_segment(x = right, y = bottom, xend = right, yend = top) +
  geom_segment(x = left, y = (bottom + height), xend = right, yend = (bottom + height)) +
  geom_segment(x = left, y = (top - height), xend = right, yend = (top - height)) +
  geom_segment(x = (left + width), y = bottom, xend = (left + width), yend = top) +
  geom_segment(x = (right - width), y = bottom, xend = (right - width), yend = top) +
  geom_segment(x = left, y = 0, xend = right, yend = 0) +
  geom_segment(x = left, y = 0, xend = left, yend = (4.25/12)) +
  geom_segment(x = left, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = 0, xend = right, yend = (4.25/12)) +
  xlim(-3,3) + ylim(0, 5) +
  coord_fixed() +
  ggtitle(paste("Slider"), paste(diaz_sl_25_00$usage_percent,"%")) +
  theme(legend.position = "none",
        plot.title = element_text(color = "black", size = 15, face = "bold"),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        panel.border = element_rect(color = "black", size = 1.5, fill = NA))

#Plots
plot_22 <- ggarrange(ff_total_22_00,
          sl_total_22_00, nrow = 1, ncol = 2) %>%
  annotate_figure(plot, top = text_grob("Diaz 2022, 0-0", 
                                        color = "red", face = "italic", size = 14))
plot_24 <- ggarrange(ff_total_24_00,
          sl_total_24_00, nrow = 1, ncol = 2) %>%
  annotate_figure(plot, top = text_grob("Diaz 2024, 0-0", 
                                        color = "red", face = "italic", size = 14))

plot_25 <- ggarrange(ff_total_25_00,
          sl_total_25_00, nrow = 1, ncol = 2) %>%
  annotate_figure(plot, top = text_grob("Diaz 2025, 0-0", 
                                        color = "red", face = "italic", size = 14))

plot_22
plot_24
plot_25
```

The trend of increasing fastballs shows up here still, and you can see his fastball gravitating upwards in these 0-0 counts. While 2025 is really tough to judge, after 2022 his fastball seemed to be trending up in the zone further and his slider in 2025 is hitting the wrong side of the plate (inside on RHH). {What it shows}.

```{r}
#Overall chase/whiff stats
diaz <- diaz %>%
  mutate(whiff = case_when(
    description == "swinging_strike" ~ 1,
    .default = 0
  ),
  in_zone = case_when(plate_x < left | plate_x > right | 
                            plate_z < bottom | plate_z > top ~ 0,
                      .default = 1),
  chase = case_when(!(description %in% c("ball", "called_strike", "blocked_ball", "hit_by_pitch")) & in_zone == "0" ~ 1,
                    .default = 0)) %>%
  mutate(count_type = case_when(
    count == "0-0" ~ "0-0",
    count %in% c("1-1", "2-2") ~ "even",
    count %in% c("0-1", "0-2", "1-2") ~ "ahead",
    count %in% c("1-0", "2-0", "3-0", "2-1", "3-1", "3-2") ~ "behind"))

diaz_summary <- diaz %>%
  group_by(game_year, count_type, pitch_type) %>%
  summarize(
    total = n(),
    chases = sum(chase, na.rm = T),
    whiffs = sum(whiff, na.rm = T),
    chase_perc = round((chases / total) * 100, 1),
    whiff_perc = round((whiffs / total) * 100, 1)
  ) %>%
  arrange(game_year, count_type, pitch_type)

diaz_summary %>%
  gt() %>%
  tab_header(
    title = "Diaz Pitch Results by Count Type"
  )
```

```{r}
#Look at whiffs and chases
#chases
diaz_00 <- diaz %>%
  filter(count == "0-0")

diaz_ff_22_00 <- diaz_00 %>%
  filter(game_year == "2022",
         pitch_type == "FF")

freq_ff_22_00_tot <- nrow(diaz_ff_22_00)
freq_ff_22_00_chase <- nrow(filter(diaz_ff_22_00, chase == 1))

percent_ff_22_00_chase <- round((freq_ff_22_00_chase / freq_ff_22_00_tot) * 100, 1)

diaz_ff_22_00_chase <- diaz_ff_22_00 %>%
  filter(chase == 1)

ff_total_22_00 <- diaz_ff_22_00_chase %>%
  ggplot(aes(x = plate_x, y = plate_z)) +
  geom_point(aes(color = pitch_type), size = 1) +
  geom_segment(x = left, y = bottom, xend = right, yend = bottom) +
  geom_segment(x = left, y = top, xend = right, yend = top) +
  geom_segment(x = left, y = bottom, xend = left, yend = top) +
  geom_segment(x = right, y = bottom, xend = right, yend = top) +
  geom_segment(x = left, y = (bottom + height), xend = right, yend = (bottom + height)) +
  geom_segment(x = left, y = (top - height), xend = right, yend = (top - height)) +
  geom_segment(x = (left + width), y = bottom, xend = (left + width), yend = top) +
  geom_segment(x = (right - width), y = bottom, xend = (right - width), yend = top) +
  geom_segment(x = left, y = 0, xend = right, yend = 0) +
  geom_segment(x = left, y = 0, xend = left, yend = (4.25/12)) +
  geom_segment(x = left, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = 0, xend = right, yend = (4.25/12)) +
  xlim(-3,3) + ylim(0, 5) +
  coord_fixed() +
  ggtitle(paste("Fastball"), paste("0-0 Chase Percentage:", percent_ff_22_00_chase,"%")) +
  theme(legend.position = "none",
        plot.title = element_text(color = "black", size = 15, face = "bold"),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        panel.border = element_rect(color = "black", size = 1.5, fill = NA))

diaz_sl_22_00 <- diaz_00 %>%
  filter(game_year == "2022",
         pitch_type == "SL")

freq_sl_22_00_tot <- nrow(diaz_sl_22_00)
freq_sl_22_00_chase <- nrow(filter(diaz_sl_22_00, chase == 1))

percent_sl_22_00_chase <- round((freq_sl_22_00_chase / freq_sl_22_00_tot) * 100, 1)

diaz_sl_22_00_chase <- diaz_sl_22_00 %>%
  filter(chase == 1)

sl_total_22_00 <- diaz_sl_22_00_chase %>%
  ggplot(aes(x = plate_x, y = plate_z)) +
  geom_point(aes(color = pitch_type), size = 1) +
  geom_segment(x = left, y = bottom, xend = right, yend = bottom) +
  geom_segment(x = left, y = top, xend = right, yend = top) +
  geom_segment(x = left, y = bottom, xend = left, yend = top) +
  geom_segment(x = right, y = bottom, xend = right, yend = top) +
  geom_segment(x = left, y = (bottom + height), xend = right, yend = (bottom + height)) +
  geom_segment(x = left, y = (top - height), xend = right, yend = (top - height)) +
  geom_segment(x = (left + width), y = bottom, xend = (left + width), yend = top) +
  geom_segment(x = (right - width), y = bottom, xend = (right - width), yend = top) +
  geom_segment(x = left, y = 0, xend = right, yend = 0) +
  geom_segment(x = left, y = 0, xend = left, yend = (4.25/12)) +
  geom_segment(x = left, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = 0, xend = right, yend = (4.25/12)) +
  xlim(-3,3) + ylim(0, 5) +
  coord_fixed() +
  ggtitle(paste("Slider"), paste("0-0 Chase Percentage:", percent_sl_22_00_chase,"%")) +
  theme(legend.position = "none",
        plot.title = element_text(color = "black", size = 15, face = "bold"),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        panel.border = element_rect(color = "black", size = 1.5, fill = NA))

#2024
diaz_ff_24_00 <- diaz_00 %>%
  filter(game_year == "2024",
         pitch_type == "FF")

freq_ff_24_00_tot <- nrow(diaz_ff_24_00)
freq_ff_24_00_chase <- nrow(filter(diaz_ff_24_00, chase == 1))

percent_ff_24_00_chase <- round((freq_ff_24_00_chase / freq_ff_24_00_tot) * 100, 1)

diaz_ff_24_00_chase <- diaz_ff_24_00 %>%
  filter(chase == 1)

ff_total_24_00 <- diaz_ff_24_00_chase %>%
  ggplot(aes(x = plate_x, y = plate_z)) +
  geom_point(aes(color = pitch_type), size = 1) +
  geom_segment(x = left, y = bottom, xend = right, yend = bottom) +
  geom_segment(x = left, y = top, xend = right, yend = top) +
  geom_segment(x = left, y = bottom, xend = left, yend = top) +
  geom_segment(x = right, y = bottom, xend = right, yend = top) +
  geom_segment(x = left, y = (bottom + height), xend = right, yend = (bottom + height)) +
  geom_segment(x = left, y = (top - height), xend = right, yend = (top - height)) +
  geom_segment(x = (left + width), y = bottom, xend = (left + width), yend = top) +
  geom_segment(x = (right - width), y = bottom, xend = (right - width), yend = top) +
  geom_segment(x = left, y = 0, xend = right, yend = 0) +
  geom_segment(x = left, y = 0, xend = left, yend = (4.25/12)) +
  geom_segment(x = left, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = 0, xend = right, yend = (4.25/12)) +
  xlim(-3,3) + ylim(0, 5) +
  coord_fixed() +
  ggtitle(paste("Fastball"), paste("0-0 Chase Percentage:", percent_ff_24_00_chase,"%")) +
  theme(legend.position = "none",
        plot.title = element_text(color = "black", size = 15, face = "bold"),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        panel.border = element_rect(color = "black", size = 1.5, fill = NA))


diaz_sl_24_00 <- diaz_00 %>%
  filter(game_year == "2024",
         pitch_type == "SL")

freq_sl_24_00_tot <- nrow(diaz_sl_24_00)
freq_sl_24_00_chase <- nrow(filter(diaz_sl_24_00, chase == 1))

percent_sl_24_00_chase <- round((freq_sl_24_00_chase / freq_sl_24_00_tot) * 100, 1)

diaz_sl_24_00_chase <- diaz_sl_24_00 %>%
  filter(chase == 1)

sl_total_24_00 <- diaz_sl_24_00_chase %>%
  ggplot(aes(x = plate_x, y = plate_z)) +
  geom_point(aes(color = pitch_type), size = 1) +
  geom_segment(x = left, y = bottom, xend = right, yend = bottom) +
  geom_segment(x = left, y = top, xend = right, yend = top) +
  geom_segment(x = left, y = bottom, xend = left, yend = top) +
  geom_segment(x = right, y = bottom, xend = right, yend = top) +
  geom_segment(x = left, y = (bottom + height), xend = right, yend = (bottom + height)) +
  geom_segment(x = left, y = (top - height), xend = right, yend = (top - height)) +
  geom_segment(x = (left + width), y = bottom, xend = (left + width), yend = top) +
  geom_segment(x = (right - width), y = bottom, xend = (right - width), yend = top) +
  geom_segment(x = left, y = 0, xend = right, yend = 0) +
  geom_segment(x = left, y = 0, xend = left, yend = (4.25/12)) +
  geom_segment(x = left, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = 0, xend = right, yend = (4.25/12)) +
  xlim(-3,3) + ylim(0, 5) +
  coord_fixed() +
  ggtitle(paste("Slider"), paste("0-0 Chase Percentage:", percent_sl_24_00_chase,"%")) +
  theme(legend.position = "none",
        plot.title = element_text(color = "black", size = 15, face = "bold"),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        panel.border = element_rect(color = "black", size = 1.5, fill = NA))

#2025
diaz_ff_25_00 <- diaz_00 %>%
  filter(game_year == "2025",
         pitch_type == "FF")

freq_ff_25_00_tot <- nrow(diaz_ff_25_00)
freq_ff_25_00_chase <- nrow(filter(diaz_ff_25_00, chase == 1))

percent_ff_25_00_chase <- round((freq_ff_25_00_chase / freq_ff_25_00_tot) * 100, 1)

diaz_ff_25_00_chase <- diaz_ff_25_00 %>%
  filter(chase == 1)

ff_total_25_00 <- diaz_ff_25_00_chase %>%
  ggplot(aes(x = plate_x, y = plate_z)) +
  geom_point(aes(color = pitch_type), size = 1) +
  geom_segment(x = left, y = bottom, xend = right, yend = bottom) +
  geom_segment(x = left, y = top, xend = right, yend = top) +
  geom_segment(x = left, y = bottom, xend = left, yend = top) +
  geom_segment(x = right, y = bottom, xend = right, yend = top) +
  geom_segment(x = left, y = (bottom + height), xend = right, yend = (bottom + height)) +
  geom_segment(x = left, y = (top - height), xend = right, yend = (top - height)) +
  geom_segment(x = (left + width), y = bottom, xend = (left + width), yend = top) +
  geom_segment(x = (right - width), y = bottom, xend = (right - width), yend = top) +
  geom_segment(x = left, y = 0, xend = right, yend = 0) +
  geom_segment(x = left, y = 0, xend = left, yend = (4.25/12)) +
  geom_segment(x = left, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = 0, xend = right, yend = (4.25/12)) +
  xlim(-3,3) + ylim(0, 5) +
  coord_fixed() +
  ggtitle(paste("Fastball"), paste("0-0 Chase Percentage:", percent_ff_25_00_chase,"%")) +
  theme(legend.position = "none",
        plot.title = element_text(color = "black", size = 15, face = "bold"),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        panel.border = element_rect(color = "black", size = 1.5, fill = NA))


diaz_sl_25_00 <- diaz_00 %>%
  filter(game_year == "2025",
         pitch_type == "SL")

freq_sl_25_00_tot <- nrow(diaz_sl_25_00)
freq_sl_25_00_chase <- nrow(filter(diaz_sl_25_00, chase == 1))

percent_sl_25_00_chase <- round((freq_sl_25_00_chase / freq_sl_25_00_tot) * 100, 1)

diaz_sl_25_00_chase <- diaz_sl_25_00 %>%
  filter(chase == 1)

sl_total_25_00 <- diaz_sl_25_00_chase %>%
  ggplot(aes(x = plate_x, y = plate_z)) +
  geom_point(aes(color = pitch_type), size = 1) +
  geom_segment(x = left, y = bottom, xend = right, yend = bottom) +
  geom_segment(x = left, y = top, xend = right, yend = top) +
  geom_segment(x = left, y = bottom, xend = left, yend = top) +
  geom_segment(x = right, y = bottom, xend = right, yend = top) +
  geom_segment(x = left, y = (bottom + height), xend = right, yend = (bottom + height)) +
  geom_segment(x = left, y = (top - height), xend = right, yend = (top - height)) +
  geom_segment(x = (left + width), y = bottom, xend = (left + width), yend = top) +
  geom_segment(x = (right - width), y = bottom, xend = (right - width), yend = top) +
  geom_segment(x = left, y = 0, xend = right, yend = 0) +
  geom_segment(x = left, y = 0, xend = left, yend = (4.25/12)) +
  geom_segment(x = left, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = 0, xend = right, yend = (4.25/12)) +
  xlim(-3,3) + ylim(0, 5) +
  coord_fixed() +
  ggtitle(paste("Slider"), paste("0-0 Chase Percentage:", percent_sl_25_00_chase,"%")) +
  theme(legend.position = "none",
        plot.title = element_text(color = "black", size = 15, face = "bold"),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        panel.border = element_rect(color = "black", size = 1.5, fill = NA))

#Plots
plot_22 <- ggarrange(ff_total_22_00,
          sl_total_22_00, nrow = 1, ncol = 2) %>%
  annotate_figure(plot, top = text_grob("Diaz 2022, 0-0 Chases", 
                                        color = "red", face = "italic", size = 14))
plot_24 <- ggarrange(ff_total_24_00,
          sl_total_24_00, nrow = 1, ncol = 2) %>%
  annotate_figure(plot, top = text_grob("Diaz 2024, 0-0 Chases", 
                                        color = "red", face = "italic", size = 14))

plot_25 <- ggarrange(ff_total_25_00,
          sl_total_25_00, nrow = 1, ncol = 2) %>%
  annotate_figure(plot, top = text_grob("Diaz 2025, 0-0 Chases", 
                                        color = "red", face = "italic", size = 14))

plot_22
plot_24
plot_25
  
```

```{r}
#whiffs in 0-0
diaz_00 <- diaz %>%
  filter(count == "0-0")

diaz_ff_22_00 <- diaz_00 %>%
  filter(game_year == "2022",
         pitch_type == "FF")

freq_ff_22_00_tot <- nrow(diaz_ff_22_00)
freq_ff_22_00_whiff <- nrow(filter(diaz_ff_22_00, whiff == 1))

percent_ff_22_00_whiff <- round((freq_ff_22_00_whiff / freq_ff_22_00_tot) * 100, 1)

diaz_ff_22_00_whiff <- diaz_ff_22_00 %>%
  filter(whiff == 1)

ff_total_22_00 <- diaz_ff_22_00_whiff %>%
  ggplot(aes(x = plate_x, y = plate_z)) +
  geom_point(aes(color = pitch_type), size = 1) +
  geom_segment(x = left, y = bottom, xend = right, yend = bottom) +
  geom_segment(x = left, y = top, xend = right, yend = top) +
  geom_segment(x = left, y = bottom, xend = left, yend = top) +
  geom_segment(x = right, y = bottom, xend = right, yend = top) +
  geom_segment(x = left, y = (bottom + height), xend = right, yend = (bottom + height)) +
  geom_segment(x = left, y = (top - height), xend = right, yend = (top - height)) +
  geom_segment(x = (left + width), y = bottom, xend = (left + width), yend = top) +
  geom_segment(x = (right - width), y = bottom, xend = (right - width), yend = top) +
  geom_segment(x = left, y = 0, xend = right, yend = 0) +
  geom_segment(x = left, y = 0, xend = left, yend = (4.25/12)) +
  geom_segment(x = left, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = 0, xend = right, yend = (4.25/12)) +
  xlim(-3,3) + ylim(0, 5) +
  coord_fixed() +
  ggtitle(paste("Fastball"), paste("0-0 Whiff Percentage:", percent_ff_22_00_whiff,"%")) +
  theme(legend.position = "none",
        plot.title = element_text(color = "black", size = 15, face = "bold"),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        panel.border = element_rect(color = "black", size = 1.5, fill = NA))

diaz_sl_22_00 <- diaz_00 %>%
  filter(game_year == "2022",
         pitch_type == "SL")

freq_sl_22_00_tot <- nrow(diaz_sl_22_00)
freq_sl_22_00_whiff <- nrow(filter(diaz_sl_22_00, whiff == 1))

percent_sl_22_00_whiff <- round((freq_sl_22_00_whiff / freq_sl_22_00_tot) * 100, 1)

diaz_sl_22_00_whiff <- diaz_sl_22_00 %>%
  filter(whiff == 1)

sl_total_22_00 <- diaz_sl_22_00_whiff %>%
  ggplot(aes(x = plate_x, y = plate_z)) +
  geom_point(aes(color = pitch_type), size = 1) +
  geom_segment(x = left, y = bottom, xend = right, yend = bottom) +
  geom_segment(x = left, y = top, xend = right, yend = top) +
  geom_segment(x = left, y = bottom, xend = left, yend = top) +
  geom_segment(x = right, y = bottom, xend = right, yend = top) +
  geom_segment(x = left, y = (bottom + height), xend = right, yend = (bottom + height)) +
  geom_segment(x = left, y = (top - height), xend = right, yend = (top - height)) +
  geom_segment(x = (left + width), y = bottom, xend = (left + width), yend = top) +
  geom_segment(x = (right - width), y = bottom, xend = (right - width), yend = top) +
  geom_segment(x = left, y = 0, xend = right, yend = 0) +
  geom_segment(x = left, y = 0, xend = left, yend = (4.25/12)) +
  geom_segment(x = left, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = 0, xend = right, yend = (4.25/12)) +
  xlim(-3,3) + ylim(0, 5) +
  coord_fixed() +
  ggtitle(paste("Slider"), paste("0-0 Whiff Percentage:", percent_sl_22_00_whiff,"%")) +
  theme(legend.position = "none",
        plot.title = element_text(color = "black", size = 15, face = "bold"),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        panel.border = element_rect(color = "black", size = 1.5, fill = NA))

#2024
diaz_ff_24_00 <- diaz_00 %>%
  filter(game_year == "2024",
         pitch_type == "FF")

freq_ff_24_00_tot <- nrow(diaz_ff_24_00)
freq_ff_24_00_whiff <- nrow(filter(diaz_ff_24_00, whiff == 1))

percent_ff_24_00_whiff <- round((freq_ff_24_00_whiff / freq_ff_24_00_tot) * 100, 1)

diaz_ff_24_00_whiff <- diaz_ff_24_00 %>%
  filter(whiff == 1)

ff_total_24_00 <- diaz_ff_24_00_whiff %>%
  ggplot(aes(x = plate_x, y = plate_z)) +
  geom_point(aes(color = pitch_type), size = 1) +
  geom_segment(x = left, y = bottom, xend = right, yend = bottom) +
  geom_segment(x = left, y = top, xend = right, yend = top) +
  geom_segment(x = left, y = bottom, xend = left, yend = top) +
  geom_segment(x = right, y = bottom, xend = right, yend = top) +
  geom_segment(x = left, y = (bottom + height), xend = right, yend = (bottom + height)) +
  geom_segment(x = left, y = (top - height), xend = right, yend = (top - height)) +
  geom_segment(x = (left + width), y = bottom, xend = (left + width), yend = top) +
  geom_segment(x = (right - width), y = bottom, xend = (right - width), yend = top) +
  geom_segment(x = left, y = 0, xend = right, yend = 0) +
  geom_segment(x = left, y = 0, xend = left, yend = (4.25/12)) +
  geom_segment(x = left, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = 0, xend = right, yend = (4.25/12)) +
  xlim(-3,3) + ylim(0, 5) +
  coord_fixed() +
  ggtitle(paste("Fastball"), paste("0-0 Whiff Percentage:", percent_ff_24_00_whiff,"%")) +
  theme(legend.position = "none",
        plot.title = element_text(color = "black", size = 15, face = "bold"),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        panel.border = element_rect(color = "black", size = 1.5, fill = NA))


diaz_sl_24_00 <- diaz_00 %>%
  filter(game_year == "2024",
         pitch_type == "SL")

freq_sl_24_00_tot <- nrow(diaz_sl_24_00)
freq_sl_24_00_whiff <- nrow(filter(diaz_sl_24_00, whiff == 1))

percent_sl_24_00_whiff <- round((freq_sl_24_00_whiff / freq_sl_24_00_tot) * 100, 1)

diaz_sl_24_00_whiff <- diaz_sl_24_00 %>%
  filter(whiff == 1)

sl_total_24_00 <- diaz_sl_24_00_whiff %>%
  ggplot(aes(x = plate_x, y = plate_z)) +
  geom_point(aes(color = pitch_type), size = 1) +
  geom_segment(x = left, y = bottom, xend = right, yend = bottom) +
  geom_segment(x = left, y = top, xend = right, yend = top) +
  geom_segment(x = left, y = bottom, xend = left, yend = top) +
  geom_segment(x = right, y = bottom, xend = right, yend = top) +
  geom_segment(x = left, y = (bottom + height), xend = right, yend = (bottom + height)) +
  geom_segment(x = left, y = (top - height), xend = right, yend = (top - height)) +
  geom_segment(x = (left + width), y = bottom, xend = (left + width), yend = top) +
  geom_segment(x = (right - width), y = bottom, xend = (right - width), yend = top) +
  geom_segment(x = left, y = 0, xend = right, yend = 0) +
  geom_segment(x = left, y = 0, xend = left, yend = (4.25/12)) +
  geom_segment(x = left, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = 0, xend = right, yend = (4.25/12)) +
  xlim(-3,3) + ylim(0, 5) +
  coord_fixed() +
  ggtitle(paste("Slider"), paste("0-0 Whiff Percentage:", percent_sl_24_00_whiff,"%")) +
  theme(legend.position = "none",
        plot.title = element_text(color = "black", size = 15, face = "bold"),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        panel.border = element_rect(color = "black", size = 1.5, fill = NA))

#2025
diaz_ff_25_00 <- diaz_00 %>%
  filter(game_year == "2025",
         pitch_type == "FF")

freq_ff_25_00_tot <- nrow(diaz_ff_25_00)
freq_ff_25_00_whiff <- nrow(filter(diaz_ff_25_00, whiff == 1))

percent_ff_25_00_whiff <- round((freq_ff_25_00_whiff / freq_ff_25_00_tot) * 100, 1)

diaz_ff_25_00_whiff <- diaz_ff_25_00 %>%
  filter(whiff == 1)

ff_total_25_00 <- diaz_ff_25_00_whiff %>%
  ggplot(aes(x = plate_x, y = plate_z)) +
  geom_point(aes(color = pitch_type), size = 1) +
  geom_segment(x = left, y = bottom, xend = right, yend = bottom) +
  geom_segment(x = left, y = top, xend = right, yend = top) +
  geom_segment(x = left, y = bottom, xend = left, yend = top) +
  geom_segment(x = right, y = bottom, xend = right, yend = top) +
  geom_segment(x = left, y = (bottom + height), xend = right, yend = (bottom + height)) +
  geom_segment(x = left, y = (top - height), xend = right, yend = (top - height)) +
  geom_segment(x = (left + width), y = bottom, xend = (left + width), yend = top) +
  geom_segment(x = (right - width), y = bottom, xend = (right - width), yend = top) +
  geom_segment(x = left, y = 0, xend = right, yend = 0) +
  geom_segment(x = left, y = 0, xend = left, yend = (4.25/12)) +
  geom_segment(x = left, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = 0, xend = right, yend = (4.25/12)) +
  xlim(-3,3) + ylim(0, 5) +
  coord_fixed() +
  ggtitle(paste("Fastball"), paste("0-0 Whiff Percentage:", percent_ff_25_00_whiff,"%")) +
  theme(legend.position = "none",
        plot.title = element_text(color = "black", size = 15, face = "bold"),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        panel.border = element_rect(color = "black", size = 1.5, fill = NA))


diaz_sl_25_00 <- diaz_00 %>%
  filter(game_year == "2025",
         pitch_type == "SL")

freq_sl_25_00_tot <- nrow(diaz_sl_25_00)
freq_sl_25_00_whiff <- nrow(filter(diaz_sl_25_00, whiff == 1))

percent_sl_25_00_whiff <- round((freq_sl_25_00_whiff / freq_sl_25_00_tot) * 100, 1)

diaz_sl_25_00_whiff <- diaz_sl_25_00 %>%
  filter(whiff == 1)

sl_total_25_00 <- diaz_sl_25_00_whiff %>%
  ggplot(aes(x = plate_x, y = plate_z)) +
  geom_point(aes(color = pitch_type), size = 1) +
  geom_segment(x = left, y = bottom, xend = right, yend = bottom) +
  geom_segment(x = left, y = top, xend = right, yend = top) +
  geom_segment(x = left, y = bottom, xend = left, yend = top) +
  geom_segment(x = right, y = bottom, xend = right, yend = top) +
  geom_segment(x = left, y = (bottom + height), xend = right, yend = (bottom + height)) +
  geom_segment(x = left, y = (top - height), xend = right, yend = (top - height)) +
  geom_segment(x = (left + width), y = bottom, xend = (left + width), yend = top) +
  geom_segment(x = (right - width), y = bottom, xend = (right - width), yend = top) +
  geom_segment(x = left, y = 0, xend = right, yend = 0) +
  geom_segment(x = left, y = 0, xend = left, yend = (4.25/12)) +
  geom_segment(x = left, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = 0, xend = right, yend = (4.25/12)) +
  xlim(-3,3) + ylim(0, 5) +
  coord_fixed() +
  ggtitle(paste("Slider"), paste("0-0 Whiff Percentage:", percent_sl_25_00_whiff,"%")) +
  theme(legend.position = "none",
        plot.title = element_text(color = "black", size = 15, face = "bold"),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        panel.border = element_rect(color = "black", size = 1.5, fill = NA))

#Plots
plot_22 <- ggarrange(ff_total_22_00,
          sl_total_22_00, nrow = 1, ncol = 2) %>%
  annotate_figure(plot, top = text_grob("Diaz 2022, 0-0 Whiffs", 
                                        color = "red", face = "italic", size = 14))
plot_24 <- ggarrange(ff_total_24_00,
          sl_total_24_00, nrow = 1, ncol = 2) %>%
  annotate_figure(plot, top = text_grob("Diaz 2024, 0-0 Whiffs", 
                                        color = "red", face = "italic", size = 14))

plot_25 <- ggarrange(ff_total_25_00,
          sl_total_25_00, nrow = 1, ncol = 2) %>%
  annotate_figure(plot, top = text_grob("Diaz 2025, 0-0 Whiffs", 
                                        color = "red", face = "italic", size = 14))

plot_22
plot_24
plot_25
```

```{r}
#Overall chase/whiff stats
diaz <- diaz %>%
  mutate(count_type = case_when(
    count == "0-0" ~ "0-0",
    count %in% c("1-1", "2-2") ~ "even",
    count %in% c("0-1", "0-2", "1-2") ~ "ahead",
    count %in% c("1-0", "2-0", "3-0", "2-1", "3-1", "3-2") ~ "behind"))

diaz_summary <- diaz %>%
  group_by(game_year, count_type, pitch_type) %>%
  summarize(
    total = n(),
    chases = sum(chase, na.rm = T),
    whiffs = sum(whiff, na.rm = T),
    chase_perc = round((chases / total) * 100, 1),
    whiff_perc = round((whiffs / total) * 100, 1)
  ) %>%
  arrange(game_year, count_type, pitch_type)

diaz_summary %>%
  gt() %>%
  tab_header(
    title = "Diaz Pitch Results by Count Type"
  )
```

{Comment on the two plots and DT}.

Something major that should be focused on is Pitch Tempo, or the time between pitches. Diaz missed 2023 with a knee injury, which was the same year that the pitch clock was implemented into MLB games to speed up pitchers, hitters, and overall game time. From 2022 to 2024/2025, Diaz has definitely had to speed up - his [average time between pitches](https://baseballsavant.mlb.com/savant-player/edwin-diaz-621242?stats=statcast-r-pitching-mlb&season=2025#pitch-tempo) in 2022 was 17.4 seconds, and in 2024 it was 13.8 (13.5 in 2025). With a "Fast" pitch tempo being where the pitcher takes 15 seconds or less between pitches, Diaz's Fast% has skyrocketed from 24.4% in 2022 to 71.6% in 2024 (63.6% in 2025). With a faster pace, it's possible Diaz has been more comfortable finding his fastball rather than his slider, which may explain its increased prominence.

{PLOT?}.

One more area to check out is [HardHit%](https://baseballsavant.mlb.com/savant-player/edwin-diaz-621242?stats=statcast-r-pitching-mlb#statcast-statistics)\*. In 2022, Diaz's HardHit% was 38.1% (49th percentile), in 2024 it was 30.3% (97th percentile), and in 2025 thus far it is 53.3% (9th percentile). The spike in 2024 and even the middling performance in 2022 compared with the rough start in 2025 begs the question of where this hard contact is coming from.

```{r}
diaz <- diaz %>%
  mutate(hardhit = case_when(
    launch_speed >= 95 ~ 1,
    .default = 0))

diaz_summary <- diaz %>%
  filter(!is.na(launch_speed), description == "hit_into_play") %>%
  group_by(game_year, count_type, pitch_type) %>%
  summarize(
    total = n(),
    hardhit = sum(hardhit, na.rm = T),
    hardhit_perc = round((hardhit / total) * 100, 1),
  ) %>%
  arrange(game_year, count_type, pitch_type)

diaz_summary %>%
  gt() %>%
  tab_header(
    title = "Diaz Hard Hit by Count Type"
  )
```

```{r}
#hardhit scatterplot - color by hard hit
diaz_ff_22 <- diaz %>%
  filter(game_year == "2022",
         pitch_type == "FF")

freq_ff_22_tot <- nrow(filter(diaz_ff_22, !is.na(launch_speed), description == "hit_into_play"))
freq_ff_22_hardhit <- nrow(filter(diaz_ff_22, description == "hit_into_play", hardhit == 1))

percent_ff_22_hardhit <- round((freq_ff_22_hardhit / freq_ff_22_tot) * 100, 1)

diaz_ff_22_hardhit <- diaz_ff_22 %>%
  filter(!is.na(launch_speed), description == "hit_into_play")

ff_total_22 <- diaz_ff_22_hardhit %>%
  ggplot(aes(x = plate_x, y = plate_z)) +
  geom_point(aes(color = hardhit), size = 1) +
  geom_segment(x = left, y = bottom, xend = right, yend = bottom) +
  geom_segment(x = left, y = top, xend = right, yend = top) +
  geom_segment(x = left, y = bottom, xend = left, yend = top) +
  geom_segment(x = right, y = bottom, xend = right, yend = top) +
  geom_segment(x = left, y = (bottom + height), xend = right, yend = (bottom + height)) +
  geom_segment(x = left, y = (top - height), xend = right, yend = (top - height)) +
  geom_segment(x = (left + width), y = bottom, xend = (left + width), yend = top) +
  geom_segment(x = (right - width), y = bottom, xend = (right - width), yend = top) +
  geom_segment(x = left, y = 0, xend = right, yend = 0) +
  geom_segment(x = left, y = 0, xend = left, yend = (4.25/12)) +
  geom_segment(x = left, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = 0, xend = right, yend = (4.25/12)) +
  xlim(-3,3) + ylim(0, 5) +
  coord_fixed() +
  ggtitle(paste("Fastball"), paste("HardHit Percentage:", percent_ff_22_hardhit,"%")) +
  theme(legend.position = "none",
        plot.title = element_text(color = "black", size = 15, face = "bold"),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        panel.border = element_rect(color = "black", size = 1.5, fill = NA))

diaz_sl_22 <- diaz %>%
  filter(game_year == "2022",
         pitch_type == "SL")

freq_sl_22_tot <- nrow(filter(diaz_sl_22, !is.na(launch_speed), description == "hit_into_play"))
freq_sl_22_hardhit <- nrow(filter(diaz_sl_22, description == "hit_into_play", hardhit == 1))

percent_sl_22_hardhit <- round((freq_sl_22_hardhit / freq_sl_22_tot) * 100, 1)

diaz_sl_22_hardhit <- diaz_sl_22 %>%
  filter(!is.na(launch_speed), description == "hit_into_play")

sl_total_22 <- diaz_sl_22_hardhit %>%
  ggplot(aes(x = plate_x, y = plate_z)) +
  geom_point(aes(color = hardhit), size = 1) +
  geom_segment(x = left, y = bottom, xend = right, yend = bottom) +
  geom_segment(x = left, y = top, xend = right, yend = top) +
  geom_segment(x = left, y = bottom, xend = left, yend = top) +
  geom_segment(x = right, y = bottom, xend = right, yend = top) +
  geom_segment(x = left, y = (bottom + height), xend = right, yend = (bottom + height)) +
  geom_segment(x = left, y = (top - height), xend = right, yend = (top - height)) +
  geom_segment(x = (left + width), y = bottom, xend = (left + width), yend = top) +
  geom_segment(x = (right - width), y = bottom, xend = (right - width), yend = top) +
  geom_segment(x = left, y = 0, xend = right, yend = 0) +
  geom_segment(x = left, y = 0, xend = left, yend = (4.25/12)) +
  geom_segment(x = left, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = 0, xend = right, yend = (4.25/12)) +
  xlim(-3,3) + ylim(0, 5) +
  coord_fixed() +
  ggtitle(paste("Slider"), paste("HardHit Percentage:", percent_sl_22_hardhit,"%")) +
  theme(legend.position = "none",
        plot.title = element_text(color = "black", size = 15, face = "bold"),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        panel.border = element_rect(color = "black", size = 1.5, fill = NA))

#2024
diaz_ff_24 <- diaz %>%
  filter(game_year == "2024",
         pitch_type == "FF")

freq_ff_24_tot <- nrow(filter(diaz_ff_24, !is.na(launch_speed), description == "hit_into_play"))
freq_ff_24_hardhit <- nrow(filter(diaz_ff_24, description == "hit_into_play", hardhit == 1))

percent_ff_24_hardhit <- round((freq_ff_24_hardhit / freq_ff_24_tot) * 100, 1)

diaz_ff_24_hardhit <- diaz_ff_24 %>%
  filter(!is.na(launch_speed), description == "hit_into_play")

ff_total_24 <- diaz_ff_24_hardhit %>%
  ggplot(aes(x = plate_x, y = plate_z)) +
  geom_point(aes(color = hardhit), size = 1) +
  geom_segment(x = left, y = bottom, xend = right, yend = bottom) +
  geom_segment(x = left, y = top, xend = right, yend = top) +
  geom_segment(x = left, y = bottom, xend = left, yend = top) +
  geom_segment(x = right, y = bottom, xend = right, yend = top) +
  geom_segment(x = left, y = (bottom + height), xend = right, yend = (bottom + height)) +
  geom_segment(x = left, y = (top - height), xend = right, yend = (top - height)) +
  geom_segment(x = (left + width), y = bottom, xend = (left + width), yend = top) +
  geom_segment(x = (right - width), y = bottom, xend = (right - width), yend = top) +
  geom_segment(x = left, y = 0, xend = right, yend = 0) +
  geom_segment(x = left, y = 0, xend = left, yend = (4.25/12)) +
  geom_segment(x = left, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = 0, xend = right, yend = (4.25/12)) +
  xlim(-3,3) + ylim(0, 5) +
  coord_fixed() +
  ggtitle(paste("Fastball"), paste("HardHit Percentage:", percent_ff_24_hardhit,"%")) +
  theme(legend.position = "none",
        plot.title = element_text(color = "black", size = 15, face = "bold"),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        panel.border = element_rect(color = "black", size = 1.5, fill = NA))


diaz_sl_24 <- diaz %>%
  filter(game_year == "2024",
         pitch_type == "SL")

freq_sl_24_tot <- nrow(filter(diaz_sl_24, !is.na(launch_speed), description == "hit_into_play"))
freq_sl_24_hardhit <- nrow(filter(diaz_sl_24, description == "hit_into_play", hardhit == 1))

percent_sl_24_hardhit <- round((freq_sl_24_hardhit / freq_sl_24_tot) * 100, 1)

diaz_sl_24_hardhit <- diaz_sl_24 %>%
  filter(!is.na(launch_speed), description == "hit_into_play")

sl_total_24 <- diaz_sl_24_hardhit %>%
  ggplot(aes(x = plate_x, y = plate_z)) +
  geom_point(aes(color = hardhit), size = 1) +
  geom_segment(x = left, y = bottom, xend = right, yend = bottom) +
  geom_segment(x = left, y = top, xend = right, yend = top) +
  geom_segment(x = left, y = bottom, xend = left, yend = top) +
  geom_segment(x = right, y = bottom, xend = right, yend = top) +
  geom_segment(x = left, y = (bottom + height), xend = right, yend = (bottom + height)) +
  geom_segment(x = left, y = (top - height), xend = right, yend = (top - height)) +
  geom_segment(x = (left + width), y = bottom, xend = (left + width), yend = top) +
  geom_segment(x = (right - width), y = bottom, xend = (right - width), yend = top) +
  geom_segment(x = left, y = 0, xend = right, yend = 0) +
  geom_segment(x = left, y = 0, xend = left, yend = (4.25/12)) +
  geom_segment(x = left, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = 0, xend = right, yend = (4.25/12)) +
  xlim(-3,3) + ylim(0, 5) +
  coord_fixed() +
  ggtitle(paste("Slider"), paste("HardHit Percentage:", percent_sl_24_hardhit,"%")) +
  theme(legend.position = "none",
        plot.title = element_text(color = "black", size = 15, face = "bold"),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        panel.border = element_rect(color = "black", size = 1.5, fill = NA))

#2025
diaz_ff_25 <- diaz %>%
  filter(game_year == "2025",
         pitch_type == "FF")

freq_ff_25_tot <- nrow(filter(diaz_ff_25, !is.na(launch_speed), description == "hit_into_play"))
freq_ff_25_hardhit <- nrow(filter(diaz_ff_25, description == "hit_into_play", hardhit == 1))

percent_ff_25_hardhit <- round((freq_ff_25_hardhit / freq_ff_25_tot) * 100, 1)

diaz_ff_25_hardhit <- diaz_ff_25 %>%
  filter(!is.na(launch_speed), description == "hit_into_play")

ff_total_25 <- diaz_ff_25_hardhit %>%
  ggplot(aes(x = plate_x, y = plate_z)) +
  geom_point(aes(color = hardhit), size = 1) +
  geom_segment(x = left, y = bottom, xend = right, yend = bottom) +
  geom_segment(x = left, y = top, xend = right, yend = top) +
  geom_segment(x = left, y = bottom, xend = left, yend = top) +
  geom_segment(x = right, y = bottom, xend = right, yend = top) +
  geom_segment(x = left, y = (bottom + height), xend = right, yend = (bottom + height)) +
  geom_segment(x = left, y = (top - height), xend = right, yend = (top - height)) +
  geom_segment(x = (left + width), y = bottom, xend = (left + width), yend = top) +
  geom_segment(x = (right - width), y = bottom, xend = (right - width), yend = top) +
  geom_segment(x = left, y = 0, xend = right, yend = 0) +
  geom_segment(x = left, y = 0, xend = left, yend = (4.25/12)) +
  geom_segment(x = left, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = 0, xend = right, yend = (4.25/12)) +
  xlim(-3,3) + ylim(0, 5) +
  coord_fixed() +
  ggtitle(paste("Fastball"), paste("HardHit Percentage:", percent_ff_25_hardhit,"%")) +
  theme(legend.position = "none",
        plot.title = element_text(color = "black", size = 15, face = "bold"),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        panel.border = element_rect(color = "black", size = 1.5, fill = NA))


diaz_sl_25 <- diaz %>%
  filter(game_year == "2025",
         pitch_type == "SL")

freq_sl_25_tot <- nrow(filter(diaz_sl_25, !is.na(launch_speed), description == "hit_into_play"))
freq_sl_25_hardhit <- nrow(filter(diaz_sl_25, description == "hit_into_play", hardhit == 1))

percent_sl_25_hardhit <- round((freq_sl_25_hardhit / freq_sl_25_tot) * 100, 1)

diaz_sl_25_hardhit <- diaz_sl_25 %>%
  filter(!is.na(launch_speed), description == "hit_into_play")

sl_total_25 <- diaz_sl_25_hardhit %>%
  ggplot(aes(x = plate_x, y = plate_z)) +
  geom_point(aes(color = hardhit), size = 1) +
  geom_segment(x = left, y = bottom, xend = right, yend = bottom) +
  geom_segment(x = left, y = top, xend = right, yend = top) +
  geom_segment(x = left, y = bottom, xend = left, yend = top) +
  geom_segment(x = right, y = bottom, xend = right, yend = top) +
  geom_segment(x = left, y = (bottom + height), xend = right, yend = (bottom + height)) +
  geom_segment(x = left, y = (top - height), xend = right, yend = (top - height)) +
  geom_segment(x = (left + width), y = bottom, xend = (left + width), yend = top) +
  geom_segment(x = (right - width), y = bottom, xend = (right - width), yend = top) +
  geom_segment(x = left, y = 0, xend = right, yend = 0) +
  geom_segment(x = left, y = 0, xend = left, yend = (4.25/12)) +
  geom_segment(x = left, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = (4.25/12), xend = 0, yend = (8.5/12)) +
  geom_segment(x = right, y = 0, xend = right, yend = (4.25/12)) +
  xlim(-3,3) + ylim(0, 5) +
  coord_fixed() +
  ggtitle(paste("Slider"), paste("HardHit Percentage:", percent_sl_25_hardhit,"%")) +
  theme(legend.position = "none",
        plot.title = element_text(color = "black", size = 15, face = "bold"),
        axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
        panel.background = element_blank(),
        panel.border = element_rect(color = "black", size = 1.5, fill = NA))

#Plots
plot_22 <- ggarrange(ff_total_22,
          sl_total_22, nrow = 1, ncol = 2) %>%
  annotate_figure(plot, top = text_grob("Diaz 2022, HardHit", 
                                        color = "red", face = "italic", size = 14))
plot_24 <- ggarrange(ff_total_24,
          sl_total_24, nrow = 1, ncol = 2) %>%
  annotate_figure(plot, top = text_grob("Diaz 2024, HardHit", 
                                        color = "red", face = "italic", size = 14))

plot_25 <- ggarrange(ff_total_25,
          sl_total_25, nrow = 1, ncol = 2) %>%
  annotate_figure(plot, top = text_grob("Diaz 2025, HardHit", 
                                        color = "red", face = "italic", size = 14))

plot_22
plot_24
plot_25
```

{explain plot and DT}.

# Summary/Recommendations

-   Bring the fastball down and tunnel with the slider

-   Practice pacing, especially early in counts

-   Get the slider back to the left side of the plate - this is where chases come from

\*HardHit defined as any hit 95MPH EV or higher
